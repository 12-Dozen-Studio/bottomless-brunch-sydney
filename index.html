<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Bottomless Brunch Sydney</title>
  <style>
    /* Simple reset */
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    body {
      font-family: 'Inter', Arial, sans-serif;
      line-height: 1.5;
      background: #fafafa;
      color: #333;
      padding: 8px;
    }
    h1 {
      text-align: center;
      margin-bottom: 20px;
    }
    #search-container {
      display: flex;
      justify-content: center;
      margin-bottom: 20px;
    }
    #search-input {
      width: 100%;
      max-width: 400px;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 4px;
      font-size: 16px;
    }
    #card-container {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 16px;
    }
    @media (min-width: 700px) {
      #card-container {
        grid-template-columns: repeat(3, 1fr);
      }
    }
    .card {
      background: #fff;
      border-radius: 14px;
      box-shadow: 0 2px 8px #0001;
      padding: 18px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      transition: transform 0.1s ease-in-out;
    }
    .card:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.15);
    }
    .card h2 {
      font-size: 20px;
      margin-bottom: 4px;
      color: #2c3e50;
      font-weight: 700;
    }
    .suburb {
      font-size: 12px;
      color: #888;
      margin-bottom: 3px;
    }
    .badge {
      display: inline-block;
      font-size: 12px;
      padding: 2px 10px;
      border-radius: 999px;
      margin-right: 6px;
    }
    .badge.price {
      background: #E8F5E9;
      color: #2E7D32;
    }
    .badge.cuisine {
      background: #FFF3E0;
      color: #8D6E63;
    }
    .badge.duration {
      background: #E3F2FD;
      color: #1565C0;
    }
    .days-row {
      display: flex;
      gap: 4px;
      margin: 8px 0 10px 0;
    }
    .day {
      font-size: 12px;
      width: 22px;
      height: 22px;
      border-radius: 50%;
      text-align: center;
      line-height: 22px;
      font-weight: 500;
    }
    .day.open {
      color: #fff;
      background: #43A047;
    }
    .day.closed {
      color: #BDBDBD;
      background: #F3F3F3;
    }
    .icon-links {
      margin-top: 7px;
    }
    .icon-links a {
      color: #555;
      margin-right: 16px;
      font-size: 16px;
      vertical-align: middle;
      text-decoration: none;
    }
    .icon-links a:last-child {
      margin-right: 0;
    }
    .icon-links a:hover {
      color: #2196F3;
    }
  </style>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" crossorigin="anonymous">
</head>
<body>
  <h1>Bottomless Brunch Sydney</h1>
  <div id="search-container">
    <input type="text" id="search-input" placeholder="Search by suburb or name...">
  </div>
  <div id="card-container"></div>

  <script>
    // Fetch and parse the CSV file then render cards
    async function loadCSV() {
      try {
        const response = await fetch('bottomless_brunch_sydney.csv');
        if (!response.ok) {
          throw new Error('CSV file not found');
        }
        const csvText = await response.text();
        const rows = csvText.trim().split(/\r?\n/);
        const headers = rows.shift().split(',');
        const data = rows.map(line => {
          const values = [];
          let current = '';
          let insideQuotes = false;
          for (let i = 0; i < line.length; i++) {
            const char = line[i];
            if (char === '"') {
              insideQuotes = !insideQuotes;
            } else if (char === ',' && !insideQuotes) {
              values.push(current);
              current = '';
            } else {
              current += char;
            }
          }
          values.push(current);
          const obj = {};
          headers.forEach((h, idx) => {
            obj[h] = values[idx];
          });
          return obj;
        });
        return data;
      } catch (err) {
        console.error(err);
        return [];
      }
    }

    // Render cards based on data and search
    function renderCards(data, filterText = '') {
      const container = document.getElementById('card-container');
      container.innerHTML = '';
      const lowerFilter = filterText.toLowerCase();
      data.forEach(item => {
        const name = item['Name'] || '';
        const suburb = item['Suburb'] || '';
        // filter by name or suburb
        if (lowerFilter && !name.toLowerCase().includes(lowerFilter) && !suburb.toLowerCase().includes(lowerFilter)) {
          return;
        }
        const price = item['Price (AUD)'] || '';
        const cuisine = item['Cuisine'] || '';
        const duration = item['Duration'] || '';
        const website = item['Website URL'] || '';
        const instagram = item['Instagram URL'] || '';

        // Weekday columns mapping
        const weekdays = ['M', 'T', 'W', 'Th', 'F', 'Sa', 'Su'];
        const daysStatus = weekdays.map(day => {
          const val = item[day];
          return val && val.toLowerCase() === 'yes' ? 'open' : 'closed';
        });

        const card = document.createElement('div');
        card.className = 'card';

        // Build badges html if present
        const badges = [];
        if (price) badges.push(`<span class="badge price">$${price}</span>`);
        if (cuisine) badges.push(`<span class="badge cuisine">${cuisine}</span>`);
        if (duration) badges.push(`<span class="badge duration">${duration}</span>`);

        // Build days html
        const daysHtml = daysStatus.map((status, idx) => {
          const dayLetter = weekdays[idx];
          return `<div class="day ${status}">${dayLetter}</div>`;
        }).join('');

        // Build icon links html only if URLs present
        const iconLinks = [];
        if (website && website.trim() !== '') {
          iconLinks.push(`<a href="${website}" target="_blank" rel="noopener noreferrer" aria-label="Website"><i class="fa-solid fa-globe"></i></a>`);
        }
        if (instagram && instagram.trim() !== '') {
          iconLinks.push(`<a href="${instagram}" target="_blank" rel="noopener noreferrer" aria-label="Instagram"><i class="fa-brands fa-instagram"></i></a>`);
        }

        card.innerHTML = `
          <div>
            <h2>${name}</h2>
            <div class="suburb">${suburb}</div>
            <div>${badges.join('')}</div>
            <div class="days-row">${daysHtml}</div>
          </div>
          <div class="icon-links">${iconLinks.join('')}</div>
        `;
        container.appendChild(card);
      });
    }

    // Initialize
    loadCSV().then(data => {
      let allData = data;
      renderCards(allData);
      const searchInput = document.getElementById('search-input');
      searchInput.addEventListener('input', () => {
        renderCards(allData, searchInput.value);
      });
    });
  </script>
</body>
</html>